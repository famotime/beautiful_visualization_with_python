<?xml version='1.0'?>
<opml version='2.0'>
  <head>
    <ownerEmail>
      quincy.zou@gmail.com
    </ownerEmail>
  </head>
  <body>
  <outline text="图11-1-3 (a)商业图表_经济学人&#10;" _note="import matplotlib.pyplot as plt&#10;import numpy as np&#10;import pandas as pd&#10;&#10;plt.rcParams[&quot;font.sans-serif&quot;] = 'Arial'&#10;# plt.rcParams[&quot;font.sans-serif&quot;]='SimHei' # 汉字显示设定&#10;plt.rcParams['axes.unicode_minus'] = False&#10;plt.rcParams['axes.facecolor'] = '# CFDBE7'&#10;plt.rcParams['savefig.facecolor'] = '# CFDBE7'&#10;plt.rc('axes', axisbelow=True)  # 使网格线置于图表下层&#10;&#10;df = pd.read_excel(r&quot;多数据系列柱形图.xlsx&quot;, sheet_name=&quot;原始数据&quot;)&#10;df = df.sort_values(&quot;INFO-Processing&quot;, ascending=False)  # 降序处理&#10;df&#10;```&#10;```&#10;   Quarter  TOTAL  INFO-Processing&#10;2    '05 I      7               24&#10;1       IV     19               18&#10;0  '04 III     18                8&#10;```&#10;&#10;```python&#10;x_lable = np.array(df[&quot;Quarter&quot;])&#10;x = np.arange(len(x_lable))&#10;y1 = np.array(df[&quot;INFO-Processing&quot;])&#10;y2 = np.array(df[&quot;TOTAL&quot;])&#10;width = 0.35&#10;fig = plt.figure(figsize=(5, 4.5), dpi=100, facecolor='# CFDBE7')&#10;&#10;# 调整y1轴位置，颜色，label为图例名称，与下方legend结合使用&#10;plt.bar(x, y1, width=width, color='# 01516C', label='INFO-Processing')&#10;# 调整y2轴位置，颜色，label为图例名称，与下方legend结合使用&#10;plt.bar(x+width, y2, width=width, color='# 01A4DC', label='TOTAL')&#10;plt.xticks(x+width/2, x_lable, size=12)  # 设置x轴刻度，位置,大小&#10;plt.yticks(size=12)  # 设置y轴刻度，位置,大小&#10;plt.grid(axis=&quot;y&quot;, c='w', linewidth=1.2)  # 设置y轴网格线的颜色与粗细&#10;# 将y轴网格线置于底层&#10;# plt.xlabel(&quot;Quarter&quot;,labelpad=10,size=18,)                          # 设置x轴标签,labelpad设置标签距离x轴的位置&#10;# plt.ylabel(&quot;Amount&quot;,labelpad=10,size=18,)                           # 设置y轴标签,labelpad设置标签距离y轴的位置&#10;&#10;# 显示图例，loc图例显示位置(可以用坐标方法显示），ncol图例显示几列，默认为1列,frameon设置图形边框&#10;plt.legend(loc=(0, 1.02), ncol=2, frameon=False)&#10;&#10;ax = plt.gca()  # 获取整个绘图区的句柄&#10;ax.spines['top'].set_color('none')  # 设置上‘脊梁’为无色&#10;ax.spines['right'].set_color('none')  # 设置右‘脊梁’为无色&#10;ax.spines['left'].set_color('none')  # 设置左‘脊梁’为无色&#10;ax.yaxis.set_ticks_position('right')  # y轴放置在y右边&#10;&#10;# 添加主标题&#10;plt.text(0., 1.25, s='WHERE CAPITAL SPENDING\nIS STILL HOT',&#10;         transform=ax.transAxes, weight='bold', size=20)&#10;# 添加副标题&#10;plt.text(0, 1.12, s='Column charts are used to compare values\nacross categories by using vertical bars.', transform=ax.transAxes,&#10;         weight='light', size=15)&#10;# 添加脚注&#10;plt.text(0., -0.15, s='Sources: http://zhuanlan.zhihu.com/apeter-zhang-jie',&#10;         transform=ax.transAxes, weight='light', size=10)&#10;&#10;# plt.savefig('商业图表_经济学人1.pdf',bbox_inches='tight', pad_inches=0.3)&#10;plt.show()&#10;&#10;```&#10;```&#10;&amp;lt;Figure size 500x450 with 1 Axes&amp;gt;&#10;```&#10;&#10;```python&#10;&#10;```&#10;&#10;" />
  </outline>
  </body>
</opml>