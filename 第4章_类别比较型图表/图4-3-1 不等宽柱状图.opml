<?xml version='1.0'?>
<opml version='2.0'>
  <head>
    <ownerEmail>
      quincy.zou@gmail.com
    </ownerEmail>
  </head>
  <body>
  <outline text="图4-3-1 不等宽柱状图&#10;" _note="import pandas as pd&#10;import numpy as np&#10;from plotnine import *&#10;&#10;&#10;mydata = pd.DataFrame(dict(Name=['A', 'B', 'C', 'D', 'E'],&#10;                           Scale=[35, 30, 20, 10, 5],&#10;                           ARPU=[56, 37, 63, 57, 59]))&#10;&#10;# 构造矩形X轴的起点（最小点）&#10;mydata.loc[:, 'xmin'] = 0&#10;for i in range(1, 5):&#10;    # mydata['xmin'][i] = np.sum(mydata['Scale'][0:i])&#10;    mydata.at[i, 'xmin'] = np.sum(mydata['Scale'][0:i])&#10;&#10;# 构造矩形X轴的终点（最大点）&#10;mydata.loc[:, 'xmax'] = 0&#10;for i in range(0, 5):&#10;    # mydata['xmax'][i] = np.sum(mydata['Scale'][0:i+1])&#10;    mydata.at[i, 'xmax'] = np.sum(mydata['Scale'][0:i+1])&#10;&#10;mydata.loc[:, 'label'] = 0&#10;for i in range(0, 5):&#10;    # mydata['label'][i] = np.sum(mydata['Scale'][0:i+1])-mydata['Scale'][i]/2&#10;    mydata.at[i, 'label'] = np.sum(mydata['Scale'][0:i+1])-mydata['Scale'][i]/2&#10;&#10;display(mydata)&#10;```&#10;```&#10;  Name  Scale  ARPU  xmin  xmax  label&#10;0    A     35    56     0    35     17&#10;1    B     30    37    35    65     50&#10;2    C     20    63    65    85     75&#10;3    D     10    57    85    95     90&#10;4    E      5    59    95   100     97&#10;```&#10;&#10;```python&#10;base_plot = (ggplot(mydata) +&#10;             geom_rect(aes(xmin='xmin', xmax='xmax', ymin=0, ymax='ARPU', fill='Name'), colour=&quot;black&quot;, size=0.25) +&#10;             geom_text(aes(x='label', y='ARPU+3', label='ARPU'), size=14, color=&quot;black&quot;) +&#10;             geom_text(aes(x='label', y=-4, label='Name'), size=14, color=&quot;black&quot;) +&#10;             scale_fill_hue(s=0.90, l=0.65, h=0.0417, color_space='husl') +&#10;             ylab(&quot;ARPU&quot;) +&#10;             xlab(&quot;scale&quot;) +&#10;             ylim(-5, 80) +&#10;             theme(  # panel_background=element_rect(fill=&quot;white&quot;),&#10;    # panel_grid_major = element_line(colour = &quot;grey&quot;,size=.25,linetype =&quot;dotted&quot; ),&#10;    # panel_grid_minor = element_line(colour = &quot;grey&quot;,size=.25,linetype =&quot;dotted&quot; ),&#10;    text=element_text(size=15),&#10;    legend_position=&quot;none&quot;,&#10;    aspect_ratio=1.15,&#10;    figure_size=(5, 5),&#10;    dpi=100&#10;))&#10;print(base_plot)&#10;```&#10;```&#10;&amp;lt;Figure size 500x578.734 with 1 Axes&amp;gt;&#10;```&#10;&#10;```python&#10;&#10;```&#10;&#10;" />
  </outline>
  </body>
</opml>